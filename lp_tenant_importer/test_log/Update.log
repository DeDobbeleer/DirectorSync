(.venv) sysadmin@C2834957912:~/dev/DirectorSync/lp_tenant_importer$ python main.py --tenant core --xlsx core_config.xlsx --format table --no-verify import-routing-policies
{"level": "DEBUG", "message": "Loading .env from: /home/sysadmin/dev/DirectorSync/lp_tenant_importer/.env", "module": "main", "funcName": "<module>", "lineno": 25, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Parsed arguments: {'tenant': 'core', 'tenants_file': None, 'xlsx': 'core_config.xlsx', 'dry_run': False, 'no_verify': True, 'format': 'table', 'force_create': False, 'command': 'import-routing-policies', 'func': <function cmd_import_routing_policies at 0x7abd24809f80>}", "module": "main", "funcName": "main", "lineno": 212, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Loaded API token: ******** (length=564)", "module": "main", "funcName": "_prepare_context", "lineno": 38, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Initialized with base_url=https://10.160.144.185, api_token=**** (raw length=564)", "module": "http", "funcName": "__init__", "lineno": 25, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Headers set: {'User-Agent': 'python-requests/2.32.5', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InN1Y2Nlc3MiOjEsIl9rZXkiOiIxMDA1MyIsIl9pZCI6IkRDVXNlcnMvMTAwNTMiLCJ1c2VybmFtZSI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkBsb2dwb2ludC5jb20iLCJyb2xlIjoiYWRtaW4iLCJ1c2VyZ3JvdXBzIjpbXSwiYWN0aXZlIjowLCJpc19uZXciOjEsInBhcmVudF9pZCI6InJvb3QiLCJwYXJlbnRfZGlzcGxheV9uYW1lIjoicm9vdCIsInVwZGF0ZWRfYnkiOiJyb290IiwiYXV0aFR5cGUiOiJkY19hdXRoIn0sInRva2VuVXVpZCI6IjFkZjMyYzc3LTVlZjktNDQxZi04YjJjLWE3ZDgxM2Q0MDJjZSIsInRva2VuVHlwZSI6InVzZXJfZ2VuZXJhdGVkIiwic2NvcGUiOiJhZG1pbiIsImlhdCI6MTc1ODU4NjcyM30.i2H8apMSFYr1oh2Rfk4LYqNU4FN6843QNRSGm-xLeGA', 'Content-Type': 'application/json'}", "module": "http", "funcName": "__init__", "lineno": 31, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "tenant config : {'tenants': {'core': {'pool_uuid': 'a9fa7661c4f84b278b136e94a86b4ea2', 'siems': {'search_heads': [{'id': 'fake-sh-id', 'name': 'fake-search-head'}], 'backends': [{'id': '506caf32de83054497d07c3c632a98cb', 'name': 'lb-backend01'}, {'id': '01925abf82fe0db0a75c190c4316b8a6', 'name': 'lb-backend02'}], 'all_in_one': []}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}}}}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}, 'xlsx': {'dir': '~/.local/share/lp_importer/', 'pattern': 'config-{tenant}.xlsx'}}}", "module": "config_loader", "funcName": "load_tenants_file", "lineno": 58, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Tenant core: 2 backends, 1 search_heads, 0 all_in_one", "module": "config_loader", "funcName": "get_tenant", "lineno": 90, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Collected nodes: 2 backends", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Collected nodes: 1 search_heads", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Collected nodes: 0 all_in_one", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "De-duplicated nodes: {'backends': [<core.nodes.Node object at 0x7abd249f49e0>, <core.nodes.Node object at 0x7abd249cd3a0>], 'search_heads': [<core.nodes.Node object at 0x7abd259eea80>], 'all_in_one': []}", "module": "main", "funcName": "_prepare_context", "lineno": 61, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "tenant config : {'tenants': {'core': {'pool_uuid': 'a9fa7661c4f84b278b136e94a86b4ea2', 'siems': {'search_heads': [{'id': 'fake-sh-id', 'name': 'fake-search-head'}], 'backends': [{'id': '506caf32de83054497d07c3c632a98cb', 'name': 'lb-backend01'}, {'id': '01925abf82fe0db0a75c190c4316b8a6', 'name': 'lb-backend02'}], 'all_in_one': []}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}}}}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}, 'xlsx': {'dir': '~/.local/share/lp_importer/', 'pattern': 'config-{tenant}.xlsx'}}}", "module": "config_loader", "funcName": "load_tenants_file", "lineno": 58, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Tenant core: 2 backends, 1 search_heads, 0 all_in_one", "module": "config_loader", "funcName": "get_tenant", "lineno": 90, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Found columns: ['original_policy_name', 'cleaned_policy_name', 'active', 'catch_all', 'rule_type', 'key', 'value', 'repo', 'drop', 'policy_id']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 86, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Found 9 routing policies in XLSX", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 87, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_cisco_amp, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_cisco_amp, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_cisco_amp with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Starting new HTTPS connection (1): 10.160.144.185:443", "module": "connectionpool", "funcName": "_new_conn", "lineno": 1049, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system_expert']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "Skipping policy rp_cisco_amp on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "INFO", "message": "Policy rp_cisco_amp on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_deception, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_deception, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_deception with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system_expert']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "Skipping policy rp_deception on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "INFO", "message": "Policy rp_deception on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_edr, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_edr, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_edr with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "Skipping policy rp_edr on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "INFO", "message": "Policy rp_edr on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_fortinet with criteria: [{'type': 'KeyPresentValueMatches', 'key': 'sub_category', 'value': 'forward', 'repo': 'Repo_secu_verbose', 'drop': 'store'}]", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu', 'Repo_secu_verbose']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "Skipping policy rp_fortinet on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu', 'Repo_secu_verbose']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "INFO", "message": "Policy rp_fortinet on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_linux, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_linux, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_linux with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "Skipping policy rp_linux on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "INFO", "message": "Policy rp_linux on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_rfsa, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_rfsa, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:47-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_rfsa with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:47-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "Skipping policy rp_rfsa on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "INFO", "message": "Policy rp_rfsa on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_rsa with criteria: [{'type': 'KeyPresentValueMatches', 'key': 'norm_id', 'value': 'Unix', 'repo': 'Repo_system', 'drop': 'store'}]", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu', 'Repo_system']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "Skipping policy rp_rsa on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu', 'Repo_system']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "INFO", "message": "Policy rp_rsa on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_tenable, setting routing_criteria = [] for this row", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 119, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "No criteria for policy rp_tenable, setting routing_criteria = []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 122, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_tenable with criteria: []", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "Skipping policy rp_tenable on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "INFO", "message": "Policy rp_tenable on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): SKIP -> Success", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Processing policy: rp_windows with criteria: [{'type': 'KeyPresentValueMatches', 'key': 'event_source', 'value': 'Microsoft-Windows-Sysmon', 'repo': 'Repo_system_verbose', 'drop': 'store'}]", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 135, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system_verbose', 'Repo_system']", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "Skipping policy rp_windows on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system_verbose', 'Repo_system']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 151, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.98828 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"257.22656 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.21875 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00781 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.01562 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":90,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.00000 MB\",\"old_repo_paths\":[{\"path\":\"/data_hot/\",\"retention\":180,\"_key\":\"/data_hot/\"},{\"path\":\"/opt/immune/storage/\",\"retention\":10,\"_key\":\"/opt/immune/storage/\"}],\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 76, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 240, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70a5cb7b6fa6ec694cc\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cd\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694ce\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694cf\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70b5cb7b6fa6ec694d0\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d1\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d2\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d3\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"repo\":\"Repo_system_verbose\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\"},{\"repo\":\"Repo_cloud\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Defender\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2c70c5cb7b6fa6ec694d4\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 257, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 260, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Update request body for https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies/68d2c70c5cb7b6fa6ec694d4: {\n  \"data\": {\n    \"policy_name\": \"rp_windows\",\n    \"active\": true,\n    \"catch_all\": \"Repo_system\",\n    \"routing_criteria\": [\n      {\n        \"type\": \"KeyPresentValueMatches\",\n        \"key\": \"event_source\",\n        \"value\": \"Microsoft-Windows-Sysmon\",\n        \"repo\": \"Repo_system_verbose\",\n        \"drop\": \"store\"\n      }\n    ]\n  }\n}", "module": "http", "funcName": "update_routing_policy", "lineno": 306, "timestamp": "2025-09-23T14:34:48-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"PUT /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies/68d2c70c5cb7b6fa6ec694d4 HTTP/1.1\" 200 153", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "DEBUG", "message": "Raw response from https://10.160.144.185/configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies/68d2c70c5cb7b6fa6ec694d4: {\"status\":\"Success\",\"message\":\"monitorapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/orders/ee2d2ad0-034a-47bb-9cf0-83daa9db7505\"}", "module": "http", "funcName": "update_routing_policy", "lineno": 310, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "INFO", "message": "Policy rp_windows on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): UPDATE -> Fail", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 236, "timestamp": "2025-09-23T14:34:48-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-23T14:34:48-0400"}
