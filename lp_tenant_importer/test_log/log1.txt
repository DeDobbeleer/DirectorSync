(.venv) sysadmin@C2834957912:~/dev/DirectorSync/lp_tenant_importer$ python main.py --tenant core --xlsx core_config.xlsx --format table --no-verify import-routing-policies
{"level": "DEBUG", "message": "Parsed arguments: {'tenant': 'core', 'tenants_file': None, 'xlsx': 'core_config.xlsx', 'dry_run': False, 'no_verify': True, 'format': 'table', 'force_create': False, 'command': 'import-routing-policies', 'func': <function cmd_import_routing_policies at 0x7b2cd9a12340>}", "module": "main", "funcName": "main", "lineno": 223, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "opening env file: /home/sysadmin/dev/DirectorSync/lp_tenant_importer/.env", "module": "main", "funcName": "_prepare_context", "lineno": 43, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Loaded API token: ******** (length=564)", "module": "main", "funcName": "_prepare_context", "lineno": 46, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Initialized with base_url=https://10.160.144.185, api_token=**** (raw length=564)", "module": "http", "funcName": "__init__", "lineno": 25, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Headers set: {'User-Agent': 'python-requests/2.32.5', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InN1Y2Nlc3MiOjEsIl9rZXkiOiIxMDA1MyIsIl9pZCI6IkRDVXNlcnMvMTAwNTMiLCJ1c2VybmFtZSI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkBsb2dwb2ludC5jb20iLCJyb2xlIjoiYWRtaW4iLCJ1c2VyZ3JvdXBzIjpbXSwiYWN0aXZlIjowLCJpc19uZXciOjEsInBhcmVudF9pZCI6InJvb3QiLCJwYXJlbnRfZGlzcGxheV9uYW1lIjoicm9vdCIsInVwZGF0ZWRfYnkiOiJyb290IiwiYXV0aFR5cGUiOiJkY19hdXRoIn0sInRva2VuVXVpZCI6IjFkZjMyYzc3LTVlZjktNDQxZi04YjJjLWE3ZDgxM2Q0MDJjZSIsInRva2VuVHlwZSI6InVzZXJfZ2VuZXJhdGVkIiwic2NvcGUiOiJhZG1pbiIsImlhdCI6MTc1ODU4NjcyM30.i2H8apMSFYr1oh2Rfk4LYqNU4FN6843QNRSGm-xLeGA', 'Content-Type': 'application/json'}", "module": "http", "funcName": "__init__", "lineno": 31, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "tenant config : {'tenants': {'core': {'pool_uuid': 'a9fa7661c4f84b278b136e94a86b4ea2', 'siems': {'search_heads': [{'id': 'fake-sh-id', 'name': 'fake-search-head'}], 'backends': [{'id': '506caf32de83054497d07c3c632a98cb', 'name': 'lb-backend01'}, {'id': '01925abf82fe0db0a75c190c4316b8a6', 'name': 'lb-backend02'}], 'all_in_one': []}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}}}}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}, 'xlsx': {'dir': '~/.local/share/lp_importer/', 'pattern': 'config-{tenant}.xlsx'}}}", "module": "config_loader", "funcName": "load_tenants_file", "lineno": 61, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Tenant core: 2 backends, 1 search_heads, 0 all_in_one", "module": "config_loader", "funcName": "get_tenant", "lineno": 93, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Collected nodes: 2 backends", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Collected nodes: 1 search_heads", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Collected nodes: 0 all_in_one", "module": "nodes", "funcName": "collect_nodes", "lineno": 28, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "De-duplicated nodes: {'backends': [<core.nodes.Node object at 0x7b2cd9fdaea0>, <core.nodes.Node object at 0x7b2cd9f888c0>], 'search_heads': [<core.nodes.Node object at 0x7b2cda22aff0>], 'all_in_one': []}", "module": "main", "funcName": "_prepare_context", "lineno": 69, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Loaded API token: {\"length\":564}", "module": "main", "funcName": "_prepare_context", "lineno": 71, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "tenant config : {'tenants': {'core': {'pool_uuid': 'a9fa7661c4f84b278b136e94a86b4ea2', 'siems': {'search_heads': [{'id': 'fake-sh-id', 'name': 'fake-search-head'}], 'backends': [{'id': '506caf32de83054497d07c3c632a98cb', 'name': 'lb-backend01'}, {'id': '01925abf82fe0db0a75c190c4316b8a6', 'name': 'lb-backend02'}], 'all_in_one': []}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}}}}, 'defaults': {'target': {'repos': ['backends', 'all_in_one'], 'routing_policies': ['backends', 'all_in_one'], 'normalization_policies': ['backends', 'all_in_one'], 'processing_policies': ['backends', 'all_in_one'], 'enrichment-policies': ['backends', 'all_in_one'], 'alerts': 'search_heads'}, 'xlsx': {'dir': '~/.local/share/lp_importer/', 'pattern': 'config-{tenant}.xlsx'}}}", "module": "config_loader", "funcName": "load_tenants_file", "lineno": 61, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Tenant core: 2 backends, 1 search_heads, 0 all_in_one", "module": "config_loader", "funcName": "get_tenant", "lineno": 93, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Found columns: ['original_policy_name', 'cleaned_policy_name', 'active', 'catch_all', 'rule_type', 'key', 'value', 'repo', 'drop', 'policy_id']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 87, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Found 9 routing policies in XLSX", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 88, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Target nodes for RP: lb-backend01, lb-backend02", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 89, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_cisco_amp: original_policy_name           rp_core_cisco_amp\ncleaned_policy_name                 rp_cisco_amp\nactive                                      True\ncatch_all                Repo-core-system-expert\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               65ba6dd9fe03d8eb8b99c0bc\nName: 7, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_cisco_amp", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_cisco_amp: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_cisco_amp: ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:33-0400"}
{"level": "DEBUG", "message": "Starting new HTTPS connection (1): 10.160.144.185:443", "module": "connectionpool", "funcName": "_new_conn", "lineno": 1049, "timestamp": "2025-09-25T06:10:33-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system_expert']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_cisco_amp on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_cisco_amp on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_deception: original_policy_name           rp_core_deception\ncleaned_policy_name                 rp_deception\nactive                                      True\ncatch_all                Repo-core-system-expert\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               65b8f271b079f715b02651e7\nName: 6, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_deception", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_deception: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_deception: ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system_expert']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_deception on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system_expert']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_deception on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_edr: original_policy_name                 rp_core_edr\ncleaned_policy_name                       rp_edr\nactive                                      True\ncatch_all                         Repo-core-secu\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               650bec16fcc3084c80c082d6\nName: 5, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_edr", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_edr: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_edr: ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_edr on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_edr on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_fortinet: original_policy_name            rp_core_fortinet\ncleaned_policy_name                  rp_fortinet\nactive                                      True\ncatch_all                         Repo-core-secu\nrule_type                 KeyPresentValueMatches\nkey                                 sub_category\nvalue                                    forward\nrepo                      Repo-core-secu-verbose\ndrop                                       store\npolicy_id               64febd765aaee58760df2761\nName: 1, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_fortinet: {'Repo_secu_verbose'}", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_fortinet: ['Repo_secu_verbose', 'Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu_verbose', 'Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_fortinet on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu_verbose', 'Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_fortinet on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_linux: original_policy_name               rp_core_linux\ncleaned_policy_name                     rp_linux\nactive                                      True\ncatch_all                       Repo-core-system\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               650af0a2dd6d1605da94a21a\nName: 4, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_linux", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_linux: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_linux: ['Repo_system']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_linux on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_linux on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_rfsa: original_policy_name                rp_core_rfsa\ncleaned_policy_name                      rp_rfsa\nactive                                      True\ncatch_all                         Repo-core-secu\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               65007b5414ffe837afabc922\nName: 2, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_rfsa", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_rfsa: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_rfsa: ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_rfsa on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_rfsa on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_rsa: original_policy_name                 rp_core_rsa\ncleaned_policy_name                       rp_rsa\nactive                                      True\ncatch_all                         Repo-core-secu\nrule_type                 KeyPresentValueMatches\nkey                                      norm_id\nvalue                                       Unix\nrepo                            Repo-core-system\ndrop                                       store\npolicy_id               65f04e099f26de83ed50e5ce\nName: 8, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_rsa: {'Repo_system'}", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_rsa: ['Repo_system', 'Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system', 'Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_rsa on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system', 'Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_rsa on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_tenable: original_policy_name             rp_core_tenable\ncleaned_policy_name                   rp_tenable\nactive                                      True\ncatch_all                         Repo-core-secu\nrule_type                                    NaN\nkey                                          NaN\nvalue                                        NaN\nrepo                                         NaN\ndrop                                         NaN\npolicy_id               65099bbcfcc3084c80c082a2\nName: 3, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "No criteria for this row in policy rp_tenable", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 140, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_tenable: set()", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_tenable: ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_secu']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_tenable on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_secu']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_tenable on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria row for rp_windows: original_policy_name             rp_core_windows\ncleaned_policy_name                   rp_windows\nactive                                      True\ncatch_all                       Repo-core-system\nrule_type                 KeyPresentValueMatches\nkey                                 event_source\nvalue                   Microsoft-Windows-Sysmon\nrepo                    Repo-core-system-verbose\ndrop                                       store\npolicy_id               64f9de0f49a44cde2b327502\nName: 0, dtype: object", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 124, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Criteria repos for rp_windows: {'Repo_system_verbose'}", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 142, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Normalized repos for rp_windows: ['Repo_system', 'Repo_system_verbose']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 145, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/506caf32de83054497d07c3c632a98cb/Repos HTTP/1.1\" 200 576", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"0.28516 MB\",\"id\":\"67db0320d177e4050fcfe2e1\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"34.91797 MB\",\"id\":\"67db0320d177e4050fcfe2e2\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.07812 MB\",\"id\":\"67db0320d177e4050fcfe2f1\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 3 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts'], missing=['Repo_system', 'Repo_system_verbose']", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "Skipping policy rp_windows on lb-backend01 (506caf32de83054497d07c3c632a98cb): missing repos ['Repo_system', 'Repo_system_verbose']", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 168, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/Repos HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"repo_number\":1,\"name\":\"default\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"1.01953 MB\",\"id\":\"6719d796573de7589e98dada\"},{\"repo_number\":2,\"name\":\"_logpoint\",\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"active\":true,\"tid\":\"\",\"repoha\":[],\"used_size\":\"303.86719 MB\",\"id\":\"6719d796573de7589e98dadb\"},{\"name\":\"_LogPointAlerts\",\"repo_number\":3,\"repopath\":[{\"path\":\"/opt/immune/storage/\",\"retention\":365}],\"tid\":\"\",\"active\":true,\"repoha\":[],\"used_size\":\"0.23438 MB\",\"id\":\"6719d796573de7589e98daea\"},{\"name\":\"Repo_system\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90},{\"path\":\"/cold_nfs/\",\"retention\":275}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":4,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb45cb7b6fa6ec694bd\"},{\"name\":\"Repo_system_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":5,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb75cb7b6fa6ec694be\"},{\"name\":\"Repo_secu\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":6,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffb95cb7b6fa6ec694bf\"},{\"name\":\"Repo_secu_verbose\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":7}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":7,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d1ffbc5cb7b6fa6ec694c0\"},{\"name\":\"Repo_system_expert\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":90}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":8,\"active\":true,\"tid\":\"\",\"used_size\":\"0.03125 MB\",\"id\":\"68d1ffbe5cb7b6fa6ec694c1\"},{\"name\":\"Repo_cloud\",\"repopath\":[{\"path\":\"/data_hot/\",\"retention\":180}],\"repoha\":[],\"store_front_port\":null,\"repo_number\":9,\"active\":true,\"tid\":\"\",\"used_size\":\"0.02344 MB\",\"id\":\"68d249955cb7b6fa6ec694cb\"}]", "module": "http", "funcName": "get_existing_repos", "lineno": 88, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 9 existing repos", "module": "http", "funcName": "get_existing_repos", "lineno": 100, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Checked repos: existing=['default', '_logpoint', '_LogPointAlerts', 'Repo_system', 'Repo_system_verbose', 'Repo_secu', 'Repo_secu_verbose', 'Repo_system_expert', 'Repo_cloud'], missing=[]", "module": "http", "funcName": "check_repos", "lineno": 252, "timestamp": "2025-09-25T06:10:34-0400"}
/home/sysadmin/dev/DirectorSync/lp_tenant_importer/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host '10.160.144.185'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
  warnings.warn(
{"level": "DEBUG", "message": "https://10.160.144.185:443 \"GET /configapi/a9fa7661c4f84b278b136e94a86b4ea2/01925abf82fe0db0a75c190c4316b8a6/RoutingPolicies HTTP/1.1\" 200 None", "module": "connectionpool", "funcName": "_make_request", "lineno": 544, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Raw response from ...: [{\"routing_criteria\":[],\"policy_name\":\"_logpoint\",\"catch_all\":\"_logpoint\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae6\"},{\"routing_criteria\":[],\"policy_name\":\"default\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98dae7\"},{\"routing_criteria\":[{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"LogPointAlert\",\"key\":\"norm_id\"},{\"repo\":\"_LogPointAlerts\",\"drop\":\"store\",\"type\":\"KeyPresentValueMatches\",\"value\":\"UEBA\",\"key\":\"norm_id\"}],\"policy_name\":\"_LogPointAlerts\",\"catch_all\":\"default\",\"active\":true,\"tid\":\"\",\"id\":\"6719d796573de7589e98daeb\"},{\"policy_name\":\"rp_cisco_amp\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d6\"},{\"policy_name\":\"rp_deception\",\"catch_all\":\"Repo_system_expert\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d7\"},{\"policy_name\":\"rp_edr\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d8\"},{\"policy_name\":\"rp_linux\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694d9\"},{\"policy_name\":\"rp_windows\",\"catch_all\":\"Repo_system\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"event_source\",\"value\":\"Microsoft-Windows-Sysmon\",\"repo\":\"Repo_system_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8665cb7b6fa6ec694da\"},{\"policy_name\":\"rp_tenable\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694db\"},{\"policy_name\":\"rp_rfsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dc\"},{\"policy_name\":\"rp_rsa\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"norm_id\",\"value\":\"Unix\",\"repo\":\"Repo_system\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694dd\"},{\"policy_name\":\"rp_fortinet\",\"catch_all\":\"Repo_secu\",\"routing_criteria\":[{\"type\":\"KeyPresentValueMatches\",\"key\":\"sub_category\",\"value\":\"forward\",\"repo\":\"Repo_secu_verbose\",\"drop\":\"store\"}],\"user\":\"admin\",\"tid\":\"\",\"active\":true,\"id\":\"68d2f8675cb7b6fa6ec694de\"}]", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 269, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "DEBUG", "message": "Fetched 12 existing routing policies", "module": "http", "funcName": "get_existing_routing_policies", "lineno": 272, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "INFO", "message": "Policy rp_windows on lb-backend02 (01925abf82fe0db0a75c190c4316b8a6): NOOP -> (N/A)", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 258, "timestamp": "2025-09-25T06:10:34-0400"}
{"level": "WARNING", "message": "No nodes available for target role all_in_one", "module": "routing_policies", "funcName": "import_routing_policies_for_nodes", "lineno": 157, "timestamp": "2025-09-25T06:10:34-0400"}
| siem                             | node         | name         | result       | action | error                                                 |
| -------------------------------- | ------------ | ------------ | ------------ | ------ | ----------------------------------------------------- |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_cisco_amp | MISSING_REPO | SKIP   | Missing repos: ['Repo_system_expert']                 |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_cisco_amp | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_deception | MISSING_REPO | SKIP   | Missing repos: ['Repo_system_expert']                 |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_deception | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_edr       | MISSING_REPO | SKIP   | Missing repos: ['Repo_secu']                          |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_edr       | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_fortinet  | MISSING_REPO | SKIP   | Missing repos: ['Repo_secu_verbose', 'Repo_secu']     |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_fortinet  | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_linux     | MISSING_REPO | SKIP   | Missing repos: ['Repo_system']                        |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_linux     | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_rfsa      | MISSING_REPO | SKIP   | Missing repos: ['Repo_secu']                          |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_rfsa      | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_rsa       | MISSING_REPO | SKIP   | Missing repos: ['Repo_system', 'Repo_secu']           |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_rsa       | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_tenable   | MISSING_REPO | SKIP   | Missing repos: ['Repo_secu']                          |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_tenable   | (N/A)        | NOOP   | —                                                     |
| 506caf32de83054497d07c3c632a98cb | lb-backend01 | rp_windows   | MISSING_REPO | SKIP   | Missing repos: ['Repo_system', 'Repo_system_verbose'] |
| 01925abf82fe0db0a75c190c4316b8a6 | lb-backend02 | rp_windows   | (N/A)        | NOOP   | —                                                     |
(.venv) sysadmin@C2834957912:~/dev/DirectorSync/lp_tenant_importer$ 
